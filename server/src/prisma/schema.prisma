generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id             String      @id @db.Uuid()
  name           String      @unique @db.VarChar(35)
  email          String      @unique @db.VarChar(60)
  password       String      @db.VarChar(150)
  avatar         String      @default("/media/default-avatar.svg") @db.VarChar(255)
  details        String      @db.VarChar(512)
  followers      Int
  communities    Community[] @relation(fields: [communityIDs], references: [id])
  communityIDs   String[]
  posts          Post[]      @relation(fields: [postIDs], references: [id])
  postIDs        String[]
  likes          Int
  interests      Interest[]  @relation(fields: [interestIDs], references: [id])
  interestIDs    String[]
  activity       String      @db.VarChar(25)
  blockedUsers   User[]
  blockedUserIDs String[]
  openDMs        DM[]
  openDMIDs      String[]
  friends        User[]
  friendIDs      String[]

  @@map(name: "user")
}

model Community {
  id        String   @id @db.Uuid()
  title     String   @unique @db.VarChar(35)
  details   String   @db.VarChar(512)
  members   User[]   @relation(fields: [memberIDs], references: [id])
  memberIDs String[]
  posts     Post[]   @relation(fields: [postIDs], references: [id])
  postIDs   String[]
  admins    User[]   @relation(fields: [adminIDs], references: [id])
  adminIDs  String[]

  @@map(name: "community")
}

model Post {
  id         String    @id @db.Uuid()
  title      String    @db.VarChar(150)
  body       String?   @db.VarChar(800)
  likes      Int
  comments   Comment[]
  commentIDs String[]
  images     String[]  @default([])
  videos     String[]  @default([])
  member     User      @relation(fields: [memberID], references: [id])
  memberID   String

  @@map(name: "post")
}

model Interest {
  id      String   @id @db.Uuid()
  name    String   @db.VarChar(35)
  users   User[]   @relation(fields: [userIDs], references: [id])
  userIDs String[]

  @@map(name: "interest")
}
